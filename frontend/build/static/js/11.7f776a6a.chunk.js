(this["webpackJsonpnext-story"]=this["webpackJsonpnext-story"]||[]).push([[11],{157:function(e,a,t){"use strict";var n=t(22),o=t(0),r=t.n(o),i=t(138),s=t(17);function l(){var e=Object(n.a)(["\n    margin-top: 85px;\n"]);return l=function(){return e},e}var c=Object(s.b)(i.a)(l());a.a=function(e){return r.a.createElement(c,{maxWidth:e.maxWidth},e.children)}},169:function(e,a,t){},350:function(e,a,t){"use strict";t.r(a);var n=t(0),o=t.n(n),r=(t(186),t(157)),i=(t(169),t(42)),s=t(352),l=t(143),c=t(342),m=t(351),u=t(340),g=t(337),d=t(345),p=t(196),v=t.n(p),f=t(140),h=t(341),b=t(138),E=t(9),S=t(161),y=t.n(S),O=t(195);function j(){return o.a.createElement(f.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",o.a.createElement(u.a,{color:"inherit",href:"https://material-ui.com/"},"NextStory")," ",(new Date).getFullYear(),".")}var x=Object(h.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(2,0,2)}}}));function w(){var e=x(),a=Object(n.useState)(""),t=Object(i.a)(a,2),r=t[0],p=t[1],h=Object(n.useState)(""),S=Object(i.a)(h,2),w=S[0],I=S[1],L=Object(n.useState)(""),N=Object(i.a)(L,2),k=N[0],C=N[1],D=Object(n.useState)(!1),G=Object(i.a)(D,2),T=G[0],W=G[1],F=Object(n.useState)(!1),J=Object(i.a)(F,2),P=J[0],q=J[1],A=Object(n.useState)(!1),Y=Object(i.a)(A,2),_=Y[0],R=Y[1],U=Object(E.g)();Object(n.useEffect)((function(){var e=sessionStorage.getItem("NS-session-data"),a=e&&JSON.parse(e),t=null===a||void 0===a?void 0:a.expiry,n=t&&new Date(t)>new Date,o=null===a||void 0===a?void 0:a.isGoogleLogin;q(n),R(o)}),[]);return o.a.createElement(b.a,{component:"main",maxWidth:"xs"},o.a.createElement(c.a,null),o.a.createElement("div",{className:e.paper},o.a.createElement(s.a,{className:e.avatar},o.a.createElement(v.a,null)),o.a.createElement(f.a,{component:"h1",variant:"h5"},"Login"),P?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{color:"red",margin:"20px"}},"You are already signed in"),o.a.createElement(u.a,{href:"/",variant:"body2"},"Go to home"),o.a.createElement("div",{style:{margin:"10px"}},"Or"),_?o.a.createElement(O.GoogleLogout,{clientId:"279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){sessionStorage.removeItem("NS-session-data"),q(!1),R(!1)}}):o.a.createElement(l.a,{color:"primary",onClick:function(){sessionStorage.removeItem("NS-session-data"),q(!1),R(!1)}},"Logout")):o.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:function(e){if(e.preventDefault(),!r||!w)return W(!0),void C("All fields must be filled in");W(!1),y.a.get("http://localhost:9000/users/notGoogleLogin/".concat(r,"/").concat(w)).then((function(e){if(e.data.passwordCorrect){var a=e.data.userId,t=e.data.name,n=new Date;n.setSeconds(n.getSeconds()+3599);var o={expiry:n,username:t,userId:a,isGoogleLogin:!1};sessionStorage.setItem("NS-session-data",JSON.stringify(o)),U.push("/")}else W(!0),C("Password is incorrect")})).catch((function(e){var a,t;W(!0);var n=(null===(a=e.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"There was an error logging in";C(n),console.log("Error logging in",e)}))}},o.a.createElement(m.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){p(e.target.value)}}),o.a.createElement(m.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){I(e.target.value)}}),T&&o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement("div",{style:{color:"red"}},k)),o.a.createElement(l.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Log In"),o.a.createElement("span",{style:{marginRight:"5px"}},"Or login with Google"),o.a.createElement(O.GoogleLogin,{clientId:"279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(e){console.log("response: ",e);var a=e.profileObj.email;a&&y.a.get("http://localhost:9000/users/googleLogin/".concat(a)).then((function(e){var a=e.data.userId,t=e.data.name,n=new Date;n.setSeconds(n.getSeconds()+3599);var o={expiry:n,username:t,userId:a,isGoogleLogin:!0};sessionStorage.setItem("NS-session-data",JSON.stringify(o)),U.push("/")})).catch((function(e){var a,t;W(!0);var n=(null===(a=e.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"There was an error logging in";C(n),console.log("Error logging in",e)}))},onFailure:function(e){console.log("on login Failure"),console.log("response: ",e),W(!0),C("There was an error logging in")},cookiePolicy:"single_host_origin"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(g.a,{container:!0},o.a.createElement(g.a,{item:!0,xs:!0},o.a.createElement(u.a,{href:"#",variant:"body2"},"Forgot password?")),o.a.createElement(g.a,{item:!0},o.a.createElement(u.a,{href:"/signup",variant:"body2"},"Don't have an account? Sign Up"))))),o.a.createElement(d.a,{mt:8},o.a.createElement(j,null)))}a.default=function(){return o.a.createElement(r.a,{maxWidth:"md"},o.a.createElement(w,null))}}}]);
//# sourceMappingURL=11.7f776a6a.chunk.js.map