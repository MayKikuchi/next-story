(this["webpackJsonpnext-story"]=this["webpackJsonpnext-story"]||[]).push([[13],{158:function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.movie="movie",e.book="book",e.start=""}(a||(a={})),function(e){e.bookPerson="bookPerson",e.moviePerson="moviePerson",e.genre="genre",e.tag="tag",e.searchBar="searchBar"}(r||(r={}))},159:function(e,t,n){"use strict";var a=n(17),r=n(0),c=n.n(r),o=n(239),i=n(14);function l(){var e=Object(a.a)(["\n    margin-top: 85px;\n    margin-bottom: 85px;\n"]);return l=function(){return e},e}var u=Object(i.b)(o.a)(l());t.a=function(e){return c.a.createElement(u,{maxWidth:e.maxWidth},e.children)}},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(75),r=function(e){return{type:a.a,filterName:e}}},167:function(e,t,n){"use strict";var a=n(17),r=n(0),c=n.n(r),o=n(14),i=n(7),l=n(158),u=n(41),s=n(73),g=n(161);function b(){var e=Object(a.a)(["\n    border-radius: 7px;\n    color: white;\n    outline: none;\n    border: none;\n    margin: 5px;\n    cursor: pointer;\n    background-color: ",";\n    &:hover {\n        background-color: ",";\n    }\n    font-size: 16px;\n    padding: 3px 5px 3px 5px;\n"]);return b=function(){return e},e}var m=o.b.button(b(),(function(e){return e.theme.palette.primary.light}),(function(e){return e.theme.palette.secondary.light})),h=Object(s.b)(null,{changeSingleSearchPageFilter:g.a})((function(e){var t=e.label,n=e.tagId,a=e.singleQueryType,r=Object(i.g)(),o=encodeURIComponent(n||t);return c.a.createElement(c.a.Fragment,null,t&&c.a.createElement(m,{onClick:function(){!function(e,t){switch(t){case l.b.bookPerson:e.changeSingleSearchPageFilter(u.b);break;case l.b.moviePerson:e.changeSingleSearchPageFilter(u.d);break;case l.b.tag:case l.b.genre:case l.b.searchBar:default:e.changeSingleSearchPageFilter(u.a)}}(e,a),r.push("/searchResult/param?singleQueryType=".concat(a,"&query=").concat(o))}},t))}));function f(){var e=Object(a.a)(["\n    margin-bottom: 15px;\n"]);return f=function(){return e},e}var p=o.b.div(f());t.a=function(e){var t=e.singleQueryType,n=e.tags,a=e.tagObjects;return c.a.createElement(p,null,n&&n.map((function(e,n){return c.a.createElement(h,{key:n,label:e,singleQueryType:t})})),!n&&a&&a.map((function(e,n){return c.a.createElement(h,{key:n,label:e.tagName,singleQueryType:t,tagId:e.tagId})})))}},173:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(41),r=function(e){return{type:a.c,filterName:e}}},186:function(e,t,n){"use strict";var a=n(40),r=n(17),c=n(0),o=n.n(c),i=n(14),l=n(151),u=n(153),s=n(147),g=n(73),b=n(173),m=n(41),h=n(161);function f(){var e=Object(r.a)(["\n"]);return f=function(){return e},e}var p=Object(i.b)(l.a)(f());t.a=Object(g.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeHomePageFilter:b.a,changeSingleSearchPageFilter:h.a})((function(e){var t=e.singleSearchPageFilter,n=e.isSearchPage,r=o.a.useState("all"),i=Object(a.a)(r,2),l=i[0],g=i[1];return Object(c.useEffect)((function(){n&&t&&g(t)}),[t]),Object(c.useEffect)((function(){switch(l){case"all":n?e.changeSingleSearchPageFilter(m.a):e.changeHomePageFilter(m.a);break;case"movies":n?e.changeSingleSearchPageFilter(m.d):e.changeHomePageFilter(m.d);break;case"books":n?e.changeSingleSearchPageFilter(m.b):e.changeHomePageFilter(m.b)}}),[l]),o.a.createElement(u.a,{smDown:!0},o.a.createElement(p,{value:l,onChange:function(e,t){g(t)},"aria-label":"home-page-filter",centered:!0},o.a.createElement(s.a,{component:"a",label:"All",value:"all"}),o.a.createElement(s.a,{component:"a",label:"Movies",value:"movies"}),o.a.createElement(s.a,{component:"a",label:"Books",value:"books"})))}))},187:function(e,t,n){"use strict";var a=n(40),r=n(17),c=n(0),o=n.n(c),i=n(14),l=n(269),u=n(153),s=n(270),g=n(188),b=n.n(g),m=n(189),h=n.n(m),f=n(190),p=n.n(f),d=n(73),v=n(173),O=n(161),j=n(41);function x(){var e=Object(r.a)(["\n    width: 100%;\n    position: fixed;\n    bottom: 0;\n"]);return x=function(){return e},e}var y=Object(i.b)(l.a)(x());t.a=Object(d.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeHomePageFilter:v.a,changeSingleSearchPageFilter:O.a})((function(e){var t=e.singleSearchPageFilter,n=e.isSearchPage,r=Object(c.useState)(j.a),i=Object(a.a)(r,2),l=i[0],g=i[1];return Object(c.useEffect)((function(){n&&t&&g(t)}),[t]),Object(c.useEffect)((function(){switch(l){case"all":n?e.changeSingleSearchPageFilter(j.a):e.changeHomePageFilter(j.a);break;case"movies":n?e.changeSingleSearchPageFilter(j.d):e.changeHomePageFilter(j.d);break;case"books":n?e.changeSingleSearchPageFilter(j.b):e.changeHomePageFilter(j.b)}}),[l]),o.a.createElement(u.a,{mdUp:!0},o.a.createElement(y,{value:l,onChange:function(e,t){g(t)},showLabels:!0,"aria-label":"home-page-filter"},o.a.createElement(s.a,{label:"All",icon:o.a.createElement(b.a,null),value:"all"}),o.a.createElement(s.a,{label:"Movies",icon:o.a.createElement(h.a,null),value:"movies"}),o.a.createElement(s.a,{label:"Books",icon:o.a.createElement(p.a,null),value:"books"})))}))},379:function(e,t,n){"use strict";n.r(t);var a=n(63),r=n(277),c=n.n(r),o=n(279),i=n(40),l=n(0),u=n.n(l),s=n(159),g=n(268),b=n(157),m=n.n(b),h=n(158),f=n(192),p=n(17),d=n(14),v=n(218),O=n(144),j=n(272),x=n(167),y=n(7),S=n(172);function k(){var e=Object(p.a)(["\n    &:hover {\n        cursor: pointer;\n    }\n"]);return k=function(){return e},e}function E(){var e=Object(p.a)(["\n    margin-bottom: 5px;\n"]);return E=function(){return e},e}function P(){var e=Object(p.a)(["\n    max-width: ",";\n    &:hover {\n        cursor: pointer;\n    }\n"]);return P=function(){return e},e}function F(){var e=Object(p.a)(["\n    display: flex;\n    justify-content: space-between;\n"]);return F=function(){return e},e}function w(){var e=Object(p.a)(["\n    border-top: ",";\n    border-bottom: ",";\n    min-height: 50px;\n    padding: 5px;\n    margin-bottom: 2px;\n"]);return w=function(){return e},e}var T=d.b.div(w(),(function(e){var t=e.theme;return"2px solid ".concat(t.palette.grey[400])}),(function(e){var t=e.theme;return"2px solid ".concat(t.palette.grey[400])})),B=d.b.div(F()),I=d.b.img(P(),(function(e){return e.isSmall?"150px":"100%"})),M=d.b.div(E()),Q=Object(d.b)(v.a)(k()),A=function(e){var t=e.image,n=e.title,a=e.blurb,r=e.genres,c=e.mediaType,o=e.mediaId,i=e.nextStoryTags,l=Object(y.g)(),s=Object(O.a)("(max-width:450px)"),g=function(){l.push("/".concat(c,"/").concat(o))};return u.a.createElement(T,null,u.a.createElement(B,null,u.a.createElement(j.a,{container:!0,direction:"row",spacing:5},u.a.createElement(j.a,{item:!0,sm:3},u.a.createElement(I,{src:t,onClick:g,isSmall:s})),u.a.createElement(j.a,{item:!0,sm:6},u.a.createElement(M,null,u.a.createElement(Q,{variant:"h5",onClick:g,color:"textPrimary",gutterBottom:!0},u.a.createElement("strong",null,n))),u.a.createElement(S.a,{content:a})),u.a.createElement(j.a,{item:!0,sm:3},"Genres:",u.a.createElement(x.a,{tags:r,singleQueryType:h.b.genre}),i&&u.a.createElement(u.a.Fragment,null,"Tags:",u.a.createElement(x.a,{tagObjects:i,singleQueryType:h.b.tag}))))))},H=function(e){var t=e.resultsToDisplay,n=e.hasMore,a=e.doNext;return u.a.createElement(f.a,{style:{overflow:"hidden"},dataLength:t.length,scrollThreshold:1,next:a,hasMore:n,loader:u.a.createElement("h4",{style:{textAlign:"center"}},"Loading more results..."),endMessage:u.a.createElement("p",{style:{textAlign:"center"}},u.a.createElement("b",null,"No more results"))},t.map((function(e,t){return u.a.createElement(A,{key:t,image:e.image,title:e.title,blurb:e.blurb,genres:e.genres,nextStoryTags:e.nextStoryTags,mediaType:e.mediaType,mediaId:e.id})})))},R=n(186),C=n(187),N=n(73),D=n(41),L=n(161);t.default=Object(N.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeSingleSearchPageFilter:L.a})((function(e){var t=decodeURI(e.location.search),n=e.singleSearchPageFilter,r=function(e){var t=e.substr(1).split("&"),n=Object(i.a)(t,2),a=n[0],r=n[1];return[a.split("=")[1],r.split("=")[1]]}(t),b=Object(i.a)(r,2),f=b[0],p=b[1],d=Object(l.useState)(0),v=Object(i.a)(d,2),O=v[0],j=v[1],x=Object(l.useState)([]),y=Object(i.a)(x,2),S=y[0],k=y[1],E=Object(l.useState)([]),P=Object(i.a)(E,2),F=P[0],w=P[1],T=Object(l.useState)([]),B=Object(i.a)(T,2),I=B[0],M=B[1],Q=Object(l.useState)(n),A=Object(i.a)(Q,2),N=A[0],L=A[1],U=Object(l.useState)(!0),W=Object(i.a)(U,2),J=W[0],Y=W[1],q=Object(l.useState)(!0),z=Object(i.a)(q,2),G=z[0],K=z[1];function V(){return(V=Object(o.a)(c.a.mark((function e(){var t,n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.prev=2,e.next=5,m.a.get("/movies/withTag/".concat(p));case 5:a=e.sent,t=a.data,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log("error fetching movies from mongo for tag",e.t0);case 12:return e.prev=12,e.next=15,m.a.get("/books/withTag/".concat(p));case 15:r=e.sent,n=r.data,e.next=22;break;case 19:e.prev=19,e.t1=e.catch(12),console.log("error fetching movies from mongo for tag",e.t1);case 22:return e.abrupt("return",[t,n]);case 23:case"end":return e.stop()}}),e,null,[[2,9],[12,19]])})))).apply(this,arguments)}function X(){return(X=Object(o.a)(c.a.mark((function e(t,n){var r,o,i,l,u,s,g,b,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],o=[],i=O+5,l=t.length>=i?i:t.length,u=n.length>=i?i:n.length,s=c.a.mark((function e(n){var r,i,l,u,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n].movieId,e.prev=1,e.next=4,m.a.get("/thirdPartyMovieApi/tmdbMovies/searchOneById/".concat(r));case 4:i=e.sent,l=i.data,u=t.filter((function(e){return e.movieId===r})),s=u.length>0&&u[0],l.nextStoryTags=s?s.nextStoryTags:[],o.push(l),M((function(e){return[].concat(Object(a.a)(e),[l])})),k((function(e){return[].concat(Object(a.a)(e),[l])})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})),g=O;case 7:if(!(g<l)){e.next=12;break}return e.delegateYield(s(g),"t0",9);case 9:g++,e.next=7;break;case 12:b=c.a.mark((function e(t){var o,i,l,u,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n[t].bookId,e.prev=1,e.next=4,m.a.get("/thirdPartyBookApi/googleBooks/searchOneById/".concat(o));case 4:i=e.sent,l=i.data,u=n.filter((function(e){return e.bookId===o})),s=u.length>0&&u[0],l.nextStoryTags=s?s.nextStoryTags:[],r.push(l),M((function(e){return[].concat(Object(a.a)(e),[l])})),w((function(e){return[].concat(Object(a.a)(e),[l])})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})),h=O;case 14:if(!(h<u)){e.next=19;break}return e.delegateYield(b(h),"t1",16);case 16:h++,e.next=14;break;case 19:return 0===o.length&&Y(!1),0===r.length&&K(!1),e.abrupt("return",[o,r]);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return(Z=Object(o.a)(c.a.mark((function e(){var t,n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.prev=2,e.next=5,m.a.get("/thirdPartyMovieApi/tmdbMovies/singleQuery/".concat(f,"/").concat(p,"/").concat(O,"/").concat(5));case 5:r=e.sent,0===(t=r.data).length?Y(!1):(k((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t))})),M((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t))}))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:return e.prev=13,e.next=16,m.a.get("/thirdPartyBookApi/googleBooks/singleQuery/".concat(f,"/").concat(p,"/").concat(O,"/").concat(5));case 16:o=e.sent,0===(n=o.data).length?K(!1):(w((function(e){return[].concat(Object(a.a)(e),Object(a.a)(n))})),M((function(e){return[].concat(Object(a.a)(e),Object(a.a)(n))}))),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(13),console.log(e.t1);case 24:return e.abrupt("return",[t,n]);case 25:case"end":return e.stop()}}),e,null,[[2,10],[13,21]])})))).apply(this,arguments)}Object(l.useEffect)((function(){L(n)}),[n]),Object(l.useEffect)((function(){switch(f){case h.b.tag:(function(){return V.apply(this,arguments)})().then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];console.log("mongo movies and books:",e),function(e,t){return X.apply(this,arguments)}(n,a).then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];console.log([n,a])})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}));break;case h.b.searchBar:case h.b.genre:case h.b.moviePerson:case h.b.bookPerson:(function(){return Z.apply(this,arguments)})().then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];console.log([n,a])})).catch((function(e){return console.log(e)}))}}),[f,p,O]);var $=Object(l.useMemo)((function(){switch(N){case D.d:return S;case D.b:return F;case D.a:default:return I}}),[N,S,F,I]),_=Object(l.useMemo)((function(){switch(N){case D.d:return J;case D.b:return G;case D.a:default:return J||G}}),[N,G,J]);return u.a.createElement(s.a,{maxWidth:"md"},u.a.createElement(g.a,{variant:"h1"},"Search Results"),u.a.createElement("br",null),u.a.createElement(R.a,{isSearchPage:!0}),u.a.createElement("br",null),u.a.createElement(H,{resultsToDisplay:$,hasMore:_,doNext:function(){j(O+5)}}),u.a.createElement("br",null),u.a.createElement(C.a,{isSearchPage:!0}))}))}}]);
//# sourceMappingURL=13.072e5769.chunk.js.map