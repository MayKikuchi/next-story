(this["webpackJsonpnext-story"]=this["webpackJsonpnext-story"]||[]).push([[17],{164:function(e,t,a){"use strict";var n=a(17),o=a(0),r=a.n(o),i=a(251),s=a(15);function l(){var e=Object(n.a)(["\n    margin-top: 85px;\n    margin-bottom: 85px;\n"]);return l=function(){return e},e}var c=Object(s.b)(i.a)(l());t.a=function(e){return r.a.createElement(c,{maxWidth:e.maxWidth},e.children)}},201:function(e,t,a){},394:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=(a(228),a(164)),i=(a(201),a(40)),s=a(371),l=a(149),c=a(385),u=a(397),m=a(227),g=a(281),d=a(238),p=a(230),v=a.n(p),f=a(280),b=a(384),h=a(251),E=a(8),S=a(162),j=a.n(S),y=a(229);function O(){return o.a.createElement(f.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",o.a.createElement(m.a,{color:"inherit",href:"https://material-ui.com/"},"NextStory")," ",(new Date).getFullYear(),".")}var x=Object(b.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(2,0,2)}}}));function w(){var e=x(),t=Object(n.useState)(""),a=Object(i.a)(t,2),r=a[0],p=a[1],b=Object(n.useState)(""),S=Object(i.a)(b,2),w=S[0],L=S[1],I=Object(n.useState)(""),N=Object(i.a)(I,2),k=N[0],C=N[1],D=Object(n.useState)(!1),G=Object(i.a)(D,2),T=G[0],W=G[1],F=Object(n.useState)(!1),J=Object(i.a)(F,2),P=J[0],q=J[1],A=Object(n.useState)(!1),_=Object(i.a)(A,2),R=_[0],U=_[1],V=Object(E.g)();Object(n.useEffect)((function(){var e=sessionStorage.getItem("NS-session-data"),t=e&&JSON.parse(e),a=null===t||void 0===t?void 0:t.expiry,n=a&&new Date(a)>new Date,o=null===t||void 0===t?void 0:t.isGoogleLogin;q(n),U(o)}),[]);return o.a.createElement(h.a,{component:"main",maxWidth:"xs"},o.a.createElement(c.a,null),o.a.createElement("div",{className:e.paper},o.a.createElement(s.a,{className:e.avatar},o.a.createElement(v.a,null)),o.a.createElement(f.a,{component:"h1",variant:"h5"},P?"Logout":"Login"),P?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{color:"red",margin:"20px"}},"Click here to logout:"),R?o.a.createElement(y.GoogleLogout,{clientId:"279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){sessionStorage.removeItem("NS-session-data"),q(!1),U(!1)}}):o.a.createElement(l.a,{color:"primary",onClick:function(){sessionStorage.removeItem("NS-session-data"),q(!1),U(!1)}},"Logout")):o.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:function(e){if(e.preventDefault(),!r||!w)return W(!0),void C("All fields must be filled in");W(!1),j.a.get("/users/notGoogleLogin/".concat(r,"/").concat(w)).then((function(e){if(e.data.passwordCorrect){var t=e.data.userId,a=e.data.name,n=new Date;n.setSeconds(n.getSeconds()+3599);var o={expiry:n,username:a,userId:t,isGoogleLogin:!1};sessionStorage.setItem("NS-session-data",JSON.stringify(o)),V.push("/")}else W(!0),C("Password is incorrect")})).catch((function(e){var t,a;W(!0);var n=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"There was an error logging in";C(n),console.log("Error logging in",e)}))}},o.a.createElement(u.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){p(e.target.value)}}),o.a.createElement(u.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){L(e.target.value)}}),T&&o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement("div",{style:{color:"red"}},k)),o.a.createElement(l.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Log In"),o.a.createElement("span",{style:{marginRight:"5px"}},"Or login with Google"),o.a.createElement(y.GoogleLogin,{clientId:"279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(e){var t=e.profileObj.email;t&&j.a.get("/users/googleLogin/".concat(t)).then((function(e){var t=e.data.userId,a=e.data.name,n=new Date;n.setSeconds(n.getSeconds()+3599);var o={expiry:n,username:a,userId:t,isGoogleLogin:!0};sessionStorage.setItem("NS-session-data",JSON.stringify(o)),V.push("/")})).catch((function(e){var t,a;W(!0);var n=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"There was an error logging in";C(n),console.log("Error logging in",e)}))},onFailure:function(e){console.log("on login Failure"),console.log("response: ",e),W(!0),C("There was an error logging in")},cookiePolicy:"single_host_origin"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(g.a,{container:!0},o.a.createElement(g.a,{item:!0},o.a.createElement(m.a,{href:"/signup",variant:"body2"},"Don't have an account? Sign Up"))))),o.a.createElement(d.a,{mt:8},o.a.createElement(O,null)))}t.default=function(){return o.a.createElement(r.a,{maxWidth:"md"},o.a.createElement(w,null))}}}]);
//# sourceMappingURL=17.cec83b64.chunk.js.map