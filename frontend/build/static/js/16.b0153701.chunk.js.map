{"version":3,"sources":["containers/Container/index.tsx","components/Login/index.tsx","containers/Login/index.tsx"],"names":["StyledContainer","styled","Container","MarginContainer","props","maxWidth","children","Copyright","Typography","variant","color","align","Link","href","Date","getFullYear","useStyles","makeStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","Login","classes","useState","email","setEmail","password","setPassword","errorMsg","setErrorMsg","loginError","setLoginError","isLoggedIn","setIsLoggedIn","isGoogleLogin","setIsGoogleLogin","history","useHistory","host","window","location","protocol","useEffect","sessionDataString","sessionStorage","getItem","sessionDataObj","JSON","parse","loginExpiry","expiry","loggedIn","googleLogin","component","CssBaseline","className","Avatar","style","clientId","buttonText","onLogoutSuccess","removeItem","Button","onClick","noValidate","onSubmit","event","preventDefault","axios","get","then","profile","data","passwordCorrect","userId","username","name","time","setSeconds","getSeconds","authObject","setItem","stringify","push","catch","error","response","message","console","log","TextField","required","fullWidth","id","label","autoComplete","autoFocus","onChange","target","value","type","Grid","item","xs","onSuccess","googleEmail","profileObj","onFailure","cookiePolicy","container","Box","mt","LoginForm"],"mappings":"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","file":"static/js/16.b0153701.chunk.js","sourcesContent":["import React, {ReactNode} from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport styled from 'styled-components';\r\n\r\nconst StyledContainer = styled(Container)`\r\n    margin-top: 85px;\r\n    margin-bottom: 85px;\r\n`;\r\n\r\ninterface MarginContainerProps {\r\n    maxWidth: 'lg'\r\n        | 'md'\r\n        | 'sm'\r\n        | 'xl'\r\n        | 'xs'\r\n        | false;\r\n    children: ReactNode;\r\n}\r\n\r\nconst MarginContainer: React.FC<MarginContainerProps> = (props: MarginContainerProps) => {\r\n    return (\r\n        <StyledContainer maxWidth={props.maxWidth}>{props.children}</StyledContainer>\r\n    );\r\n};\r\n\r\nexport default MarginContainer;\r\n","import React, {useEffect, useState} from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Link from '@material-ui/core/Link';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Box from '@material-ui/core/Box';\r\nimport FaceIcon from '@material-ui/icons/Face';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport {useHistory} from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport {GoogleLogin, GoogleLogout} from 'react-google-login';\r\n\r\nfunction Copyright() {\r\n    return (\r\n        <Typography variant='body2' color='textSecondary' align='center'>\r\n            {'Copyright Â© '}\r\n            <Link color='inherit' href='https://material-ui.com/'>\r\n                NextStory\r\n            </Link>{' '}\r\n            {new Date().getFullYear()}\r\n            {'.'}\r\n        </Typography>\r\n    );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    paper: {\r\n        marginTop: theme.spacing(8),\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center'\r\n    },\r\n    avatar: {\r\n        margin: theme.spacing(1),\r\n        backgroundColor: theme.palette.secondary.main\r\n    },\r\n    form: {\r\n        width: '100%', // Fix IE 11 issue.\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    submit: {\r\n        margin: theme.spacing(2, 0, 2)\r\n    }\r\n}));\r\n\r\nexport default function Login() {\r\n    const classes = useStyles();\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [errorMsg, setErrorMsg] = useState('');\r\n    const [loginError, setLoginError] = useState(false);\r\n\r\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n    const [isGoogleLogin, setIsGoogleLogin] = useState(false);\r\n\r\n    const history = useHistory();\r\n    const host = window.location.protocol + '//'+ window.location.host;\r\n    useEffect(() => {\r\n        const sessionDataString = sessionStorage.getItem('NS-session-data');\r\n        const sessionDataObj = sessionDataString && JSON.parse(sessionDataString);\r\n        const loginExpiry = sessionDataObj?.expiry;\r\n        const loggedIn = loginExpiry && new Date(loginExpiry) > new Date();\r\n        const googleLogin = sessionDataObj?.isGoogleLogin;\r\n        setIsLoggedIn(loggedIn);\r\n        setIsGoogleLogin(googleLogin);\r\n    }, []);\r\n\r\n    const handleLogin = (event: any) => {\r\n        event.preventDefault();\r\n        if (! email || !password) {\r\n            setLoginError(true);\r\n            setErrorMsg('All fields must be filled in');\r\n            return;\r\n        }\r\n        setLoginError(false);\r\n        axios.get(host + `/users/notGoogleLogin/${email}/${password}`)\r\n            .then((profile: any) => {\r\n                const passwordIsCorrect = profile.data.passwordCorrect;\r\n                if (passwordIsCorrect) {\r\n                    const userId = profile.data.userId;\r\n                    const username = profile.data.name;\r\n                    const time = new Date();\r\n                    time.setSeconds(time.getSeconds() + 3599); // same as google auth timeout\r\n                    const authObject = {\r\n                        expiry: time,\r\n                        username: username,\r\n                        userId: userId,\r\n                        isGoogleLogin: false\r\n                    };\r\n                    sessionStorage.setItem('NS-session-data', JSON.stringify(authObject));\r\n                    history.push(`/`);\r\n                } else {\r\n                    setLoginError(true);\r\n                    setErrorMsg('Password is incorrect');\r\n                }\r\n            })\r\n            .catch((error: any) => {\r\n                setLoginError(true);\r\n                const errorMsg = error.response?.data?.message || 'There was an error logging in';\r\n                setErrorMsg(errorMsg);\r\n                console.log('Error logging in', error);\r\n            });\r\n    };\r\n\r\n    const handleEmailChange = (event: any) => {\r\n        setEmail(event.target.value);\r\n    };\r\n\r\n    const handlePassChange = (event: any) => {\r\n        setPassword(event.target.value);\r\n    };\r\n\r\n    const onLoginSuccess = (response: any) => {\r\n        console.log('response: ', response);\r\n        const googleEmail = response.profileObj.email;\r\n        if (googleEmail) {\r\n            axios.get(host + `/users/googleLogin/${googleEmail}`)\r\n                .then((profile: any) => {\r\n                    const userId = profile.data.userId;\r\n                    const username = profile.data.name;\r\n                    const time = new Date();\r\n                    time.setSeconds(time.getSeconds() + 3599); // same as google auth timeout\r\n                    const authObject = {\r\n                        expiry: time,\r\n                        username: username,\r\n                        userId: userId,\r\n                        isGoogleLogin: true\r\n                    };\r\n                    sessionStorage.setItem('NS-session-data', JSON.stringify(authObject));\r\n                    history.push(`/`);\r\n                })\r\n                .catch((error: any) => {\r\n                    setLoginError(true);\r\n                    const errorMsg = error.response?.data?.message || 'There was an error logging in';\r\n                    setErrorMsg(errorMsg);\r\n                    console.log('Error logging in', error);\r\n                });\r\n        }\r\n    };\r\n\r\n    const onLoginFailure = (response: any) => {\r\n        console.log('on login Failure');\r\n        console.log('response: ', response);\r\n        setLoginError(true);\r\n        setErrorMsg('There was an error logging in');\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        sessionStorage.removeItem('NS-session-data');\r\n        setIsLoggedIn(false);\r\n        setIsGoogleLogin(false);\r\n    };\r\n\r\n    const handleGoogleLogout = () => {\r\n        sessionStorage.removeItem('NS-session-data');\r\n        setIsLoggedIn(false);\r\n        setIsGoogleLogin(false);\r\n    };\r\n\r\n    return (\r\n        <Container component='main' maxWidth='xs'>\r\n            <CssBaseline />\r\n            <div className={classes.paper}>\r\n                <Avatar className={classes.avatar}>\r\n                    <FaceIcon />\r\n                </Avatar>\r\n                <Typography component='h1' variant='h5'>\r\n                    {isLoggedIn ? 'Logout' : 'Login'}\r\n                </Typography>\r\n                {!isLoggedIn ? <form className={classes.form} noValidate onSubmit={handleLogin}>\r\n                    <TextField\r\n                        variant='outlined'\r\n                        margin='normal'\r\n                        required\r\n                        fullWidth\r\n                        id='email'\r\n                        label='Email Address'\r\n                        name='email'\r\n                        autoComplete='email'\r\n                        autoFocus\r\n                        onChange={handleEmailChange}\r\n                    />\r\n                    <TextField\r\n                        variant='outlined'\r\n                        margin='normal'\r\n                        required\r\n                        fullWidth\r\n                        name='password'\r\n                        label='Password'\r\n                        type='password'\r\n                        id='password'\r\n                        autoComplete='current-password'\r\n                        onChange={handlePassChange}\r\n                    />\r\n                    {loginError &&\r\n                        <Grid item xs={12}>\r\n                            <div style={{ 'color': 'red' }}>\r\n                                {errorMsg}\r\n                            </div>\r\n                        </Grid>\r\n                    }\r\n                    <Button\r\n                        type='submit'\r\n                        fullWidth\r\n                        variant='contained'\r\n                        color='primary'\r\n                        className={classes.submit}\r\n                    >\r\n                        Log In\r\n                    </Button>\r\n                    <span style={{ 'marginRight': '5px' }}>\r\n                        Or login with Google\r\n                    </span>\r\n                    <GoogleLogin\r\n                        clientId='279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com'\r\n                        buttonText='Login'\r\n                        onSuccess={onLoginSuccess}\r\n                        onFailure={onLoginFailure}\r\n                        cookiePolicy={'single_host_origin'}\r\n                    />\r\n                    <br/>\r\n                    <br/>\r\n                    <Grid container>\r\n                        <Grid item>\r\n                            <Link href='/signup' variant='body2'>\r\n                                {\"Don't have an account? Sign Up\"}\r\n                            </Link>\r\n                        </Grid>\r\n                    </Grid>\r\n                </form>\r\n                :\r\n                    <>\r\n                        <div style={{ 'color': 'red', 'margin': '20px' }}>\r\n                        Click here to logout:\r\n                        </div>\r\n                        {isGoogleLogin ? <GoogleLogout\r\n                                clientId='279438615331-cvlr0tk0j35i4s9df4m51o9sb5uj8k3s.apps.googleusercontent.com'\r\n                                buttonText='Logout'\r\n                                onLogoutSuccess={handleGoogleLogout}\r\n                            />\r\n                            :\r\n                            <Button color={'primary'} onClick={handleLogout} >\r\n                                Logout\r\n                            </Button>\r\n                        }\r\n                    </>\r\n                }\r\n            </div>\r\n            <Box mt={8}>\r\n                <Copyright />\r\n            </Box>\r\n        </Container>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport Container from '../Container';\r\nimport '../../App.css';\r\nimport Login from '../../components/Login';\r\n\r\n\r\nconst LoginForm: React.FC = () => {\r\n    return (\r\n        <Container maxWidth='md'>\r\n            <Login />\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default LoginForm;\r\n"],"sourceRoot":""}