(this["webpackJsonpnext-story"]=this["webpackJsonpnext-story"]||[]).push([[13],{163:function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.movie="movie",e.book="book",e.start=""}(a||(a={})),function(e){e.bookPerson="bookPerson",e.moviePerson="moviePerson",e.genre="genre",e.tag="tag",e.searchBar="searchBar"}(r||(r={}))},164:function(e,t,n){"use strict";var a=n(17),r=n(0),c=n.n(r),o=n(251),i=n(15);function l(){var e=Object(a.a)(["\n    margin-top: 85px;\n    margin-bottom: 85px;\n"]);return l=function(){return e},e}var s=Object(i.b)(o.a)(l());t.a=function(e){return c.a.createElement(s,{maxWidth:e.maxWidth},e.children)}},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(77),r=function(e){return{type:a.a,filterName:e}}},170:function(e,t,n){"use strict";var a=n(17),r=n(0),c=n.n(r),o=n(15),i=n(8),l=n(163),s=n(41),u=n(75),g=n(166);function b(){var e=Object(a.a)(["\n    border-radius: 7px;\n    color: white;\n    outline: none;\n    border: none;\n    margin: 5px;\n    cursor: pointer;\n    background-color: ",";\n    &:hover {\n        background-color: ",";\n    }\n    font-size: 16px;\n    padding: 3px 5px 3px 5px;\n"]);return b=function(){return e},e}var f=o.b.button(b(),(function(e){return e.theme.palette.primary.light}),(function(e){return e.theme.palette.secondary.light})),h=Object(u.b)(null,{changeSingleSearchPageFilter:g.a})((function(e){var t=e.label,n=e.tagId,a=e.singleQueryType,r=Object(i.g)(),o=encodeURIComponent(n||t);return c.a.createElement(c.a.Fragment,null,t&&c.a.createElement(f,{onClick:function(){!function(e,t){switch(t){case l.b.bookPerson:e.changeSingleSearchPageFilter(s.b);break;case l.b.moviePerson:e.changeSingleSearchPageFilter(s.d);break;case l.b.tag:case l.b.genre:case l.b.searchBar:default:e.changeSingleSearchPageFilter(s.a)}}(e,a),r.push("/searchResult/param?singleQueryType=".concat(a,"&query=").concat(o))}},t))}));function m(){var e=Object(a.a)(["\n    margin-bottom: 15px;\n"]);return m=function(){return e},e}var p=o.b.div(m());t.a=function(e){var t=e.singleQueryType,n=e.tags,a=e.tagObjects;return c.a.createElement(p,null,n&&n.map((function(e,n){return c.a.createElement(h,{key:n,label:e,singleQueryType:t})})),!n&&a&&a.map((function(e,n){return c.a.createElement(h,{key:n,label:e.tagName,singleQueryType:t,tagId:e.tagId})})))}},178:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(41),r=function(e){return{type:a.c,filterName:e}}},195:function(e,t,n){"use strict";var a=n(40),r=n(17),c=n(0),o=n.n(c),i=n(15),l=n(155),s=n(157),u=n(151),g=n(75),b=n(178),f=n(41),h=n(166);function m(){var e=Object(r.a)(["\n"]);return m=function(){return e},e}var p=Object(i.b)(l.a)(m());t.a=Object(g.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeHomePageFilter:b.a,changeSingleSearchPageFilter:h.a})((function(e){var t=e.singleSearchPageFilter,n=e.isSearchPage,r=o.a.useState("all"),i=Object(a.a)(r,2),l=i[0],g=i[1];return Object(c.useEffect)((function(){n&&t&&g(t)}),[t]),Object(c.useEffect)((function(){switch(l){case"all":n?e.changeSingleSearchPageFilter(f.a):e.changeHomePageFilter(f.a);break;case"movies":n?e.changeSingleSearchPageFilter(f.d):e.changeHomePageFilter(f.d);break;case"books":n?e.changeSingleSearchPageFilter(f.b):e.changeHomePageFilter(f.b)}}),[l]),o.a.createElement(s.a,{smDown:!0},o.a.createElement(p,{value:l,onChange:function(e,t){g(t)},"aria-label":"home-page-filter",centered:!0},o.a.createElement(u.a,{component:"a",label:"All",value:"all"}),o.a.createElement(u.a,{component:"a",label:"Movies",value:"movies"}),o.a.createElement(u.a,{component:"a",label:"Books",value:"books"})))}))},196:function(e,t,n){"use strict";var a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(63)).default)(r.default.createElement("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");t.default=c},197:function(e,t,n){"use strict";var a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(63)).default)(r.default.createElement("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"}),"Movie");t.default=c},198:function(e,t,n){"use strict";var a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(63)).default)(r.default.createElement("path",{d:"M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"}),"Book");t.default=c},208:function(e,t,n){"use strict";var a=n(40),r=n(17),c=n(0),o=n.n(c),i=n(15),l=n(1),s=n(2),u=(n(25),n(3),n(4)),g=n(5),b=c.forwardRef((function(e,t){var n=e.children,a=e.classes,r=e.className,o=e.component,i=void 0===o?"div":o,g=e.onChange,b=e.showLabels,f=void 0!==b&&b,h=e.value,m=Object(s.a)(e,["children","classes","className","component","onChange","showLabels","value"]);return c.createElement(i,Object(l.a)({className:Object(u.a)(a.root,r),ref:t},m),c.Children.map(n,(function(e,t){if(!c.isValidElement(e))return null;var n=void 0===e.props.value?t:e.props.value;return c.cloneElement(e,{selected:n===h,showLabel:void 0!==e.props.showLabel?e.props.showLabel:f,value:n,onChange:g})})))})),f=Object(g.a)((function(e){return{root:{display:"flex",justifyContent:"center",height:56,backgroundColor:e.palette.background.paper}}}),{name:"MuiBottomNavigation"})(b),h=n(157),m=n(74),p=c.forwardRef((function(e,t){var n=e.classes,a=e.className,r=e.icon,o=e.label,i=e.onChange,g=e.onClick,b=e.selected,f=e.showLabel,h=e.value,p=Object(s.a)(e,["classes","className","icon","label","onChange","onClick","selected","showLabel","value"]);return c.createElement(m.a,Object(l.a)({ref:t,className:Object(u.a)(n.root,a,b?n.selected:!f&&n.iconOnly),focusRipple:!0,onClick:function(e){i&&i(e,h),g&&g(e)}},p),c.createElement("span",{className:n.wrapper},r,c.createElement("span",{className:Object(u.a)(n.label,b?n.selected:!f&&n.iconOnly)},o)))})),d=Object(g.a)((function(e){return{root:{transition:e.transitions.create(["color","padding-top"],{duration:e.transitions.duration.short}),padding:"6px 12px 8px",minWidth:80,maxWidth:168,color:e.palette.text.secondary,flex:"1","&$iconOnly":{paddingTop:16},"&$selected":{paddingTop:6,color:e.palette.primary.main}},selected:{},iconOnly:{},wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"100%",flexDirection:"column"},label:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s","&$iconOnly":{opacity:0,transitionDelay:"0s"},"&$selected":{fontSize:e.typography.pxToRem(14)}}}}),{name:"MuiBottomNavigationAction"})(p),v=n(196),O=n.n(v),y=n(197),j=n.n(y),x=n(198),E=n.n(x),S=n(75),k=n(178),P=n(166),w=n(41);function F(){var e=Object(r.a)(["\n    width: 100%;\n    position: fixed;\n    bottom: 0;\n"]);return F=function(){return e},e}var T=Object(i.b)(f)(F());t.a=Object(S.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeHomePageFilter:k.a,changeSingleSearchPageFilter:P.a})((function(e){var t=e.singleSearchPageFilter,n=e.isSearchPage,r=Object(c.useState)(w.a),i=Object(a.a)(r,2),l=i[0],s=i[1];return Object(c.useEffect)((function(){n&&t&&s(t)}),[t]),Object(c.useEffect)((function(){switch(l){case"all":n?e.changeSingleSearchPageFilter(w.a):e.changeHomePageFilter(w.a);break;case"movies":n?e.changeSingleSearchPageFilter(w.d):e.changeHomePageFilter(w.d);break;case"books":n?e.changeSingleSearchPageFilter(w.b):e.changeHomePageFilter(w.b)}}),[l]),o.a.createElement(h.a,{mdUp:!0},o.a.createElement(T,{value:l,onChange:function(e,t){s(t)},showLabels:!0,"aria-label":"home-page-filter"},o.a.createElement(d,{label:"All",icon:o.a.createElement(O.a,null),value:"all"}),o.a.createElement(d,{label:"Movies",icon:o.a.createElement(j.a,null),value:"movies"}),o.a.createElement(d,{label:"Books",icon:o.a.createElement(E.a,null),value:"books"})))}))},209:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(187),o=n(17),i=n(15),l=n(227),s=n(148),u=n(281),g=n(163),b=n(170),f=n(8),h=n(177);function m(){var e=Object(o.a)(["\n    &:hover {\n        cursor: pointer;\n    }\n"]);return m=function(){return e},e}function p(){var e=Object(o.a)(["\n    margin-bottom: 5px;\n"]);return p=function(){return e},e}function d(){var e=Object(o.a)(["\n    max-width: ",";\n    &:hover {\n        cursor: pointer;\n    }\n"]);return d=function(){return e},e}function v(){var e=Object(o.a)(["\n    display: flex;\n    justify-content: space-between;\n"]);return v=function(){return e},e}function O(){var e=Object(o.a)(["\n    border-top: ",";\n    border-bottom: ",";\n    min-height: 50px;\n    padding: 5px;\n    margin-bottom: 2px;\n"]);return O=function(){return e},e}var y=i.b.div(O(),(function(e){var t=e.theme;return"2px solid ".concat(t.palette.grey[400])}),(function(e){var t=e.theme;return"2px solid ".concat(t.palette.grey[400])})),j=i.b.div(v()),x=i.b.img(d(),(function(e){return e.isSmall?"150px":"100%"})),E=i.b.div(p()),S=Object(i.b)(l.a)(m()),k=function(e){var t=e.image,n=e.title,a=e.blurb,c=e.genres,o=e.mediaType,i=e.mediaId,l=e.nextStoryTags,m=Object(f.g)(),p=Object(s.a)("(max-width:450px)"),d=function(){m.push("/".concat(o,"/").concat(i))};return r.a.createElement(y,null,r.a.createElement(j,null,r.a.createElement(u.a,{container:!0,direction:"row",spacing:5},r.a.createElement(u.a,{item:!0,sm:3},r.a.createElement(x,{src:t,onClick:d,isSmall:p})),r.a.createElement(u.a,{item:!0,sm:6},r.a.createElement(E,null,r.a.createElement(S,{variant:"h5",onClick:d,color:"textPrimary",gutterBottom:!0},r.a.createElement("strong",null,n))),r.a.createElement(h.a,{content:a})),r.a.createElement(u.a,{item:!0,sm:3},"Genres:",r.a.createElement(b.a,{tags:c,singleQueryType:g.b.genre}),l&&r.a.createElement(r.a.Fragment,null,"Tags:",r.a.createElement(b.a,{tagObjects:l,singleQueryType:g.b.tag}))))))};t.a=function(e){var t=e.resultsToDisplay,n=e.hasMore,a=e.doNext;return r.a.createElement(c.a,{style:{overflow:"hidden"},dataLength:t.length,scrollThreshold:1,next:a,hasMore:n,loader:r.a.createElement("h4",{style:{textAlign:"center"}},"Loading more results..."),endMessage:r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("b",null,"No more results"))},t.map((function(e,t){return r.a.createElement(k,{key:t,image:e.image,title:e.title,blurb:e.blurb,genres:e.genres,nextStoryTags:e.nextStoryTags,mediaType:e.mediaType,mediaId:e.id})})))}},383:function(e,t,n){"use strict";n.r(t);var a=n(64),r=n(179),c=n.n(r),o=n(180),i=n(40),l=n(0),s=n.n(l),u=n(164),g=n(280),b=n(162),f=n.n(b),h=n(163),m=n(209),p=n(195),d=n(208),v=n(75),O=n(41),y=n(166);t.default=Object(v.b)((function(e){return{singleSearchPageFilter:e.singleSearchPageFilterReducer}}),{changeSingleSearchPageFilter:y.a})((function(e){var t=decodeURI(e.location.search),n=e.singleSearchPageFilter,r=function(e){var t=e.substr(1).split("&"),n=Object(i.a)(t,2),a=n[0],r=n[1];return[a.split("=")[1],r.split("=")[1]]}(t),b=Object(i.a)(r,2),v=b[0],y=b[1],j=Object(l.useState)(0),x=Object(i.a)(j,2),E=x[0],S=x[1],k=Object(l.useState)([]),P=Object(i.a)(k,2),w=P[0],F=P[1],T=Object(l.useState)([]),M=Object(i.a)(T,2),C=M[0],B=M[1],N=Object(l.useState)([]),I=Object(i.a)(N,2),L=I[0],H=I[1],R=Object(l.useState)(n),A=Object(i.a)(R,2),Q=A[0],z=A[1],D=Object(l.useState)(!0),_=Object(i.a)(D,2),W=_[0],V=_[1],$=Object(l.useState)(!0),U=Object(i.a)($,2),J=U[0],Y=U[1];function q(){return(q=Object(o.a)(c.a.mark((function e(){var t,n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.prev=2,e.next=5,f.a.get("/movies/withTag/".concat(y));case 5:a=e.sent,t=a.data,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log("error fetching movies from mongo for tag",e.t0);case 12:return e.prev=12,e.next=15,f.a.get("/books/withTag/".concat(y));case 15:r=e.sent,n=r.data,e.next=22;break;case 19:e.prev=19,e.t1=e.catch(12),console.log("error fetching books from mongo for tag",e.t1);case 22:return e.abrupt("return",[t,n]);case 23:case"end":return e.stop()}}),e,null,[[2,9],[12,19]])})))).apply(this,arguments)}function G(){return(G=Object(o.a)(c.a.mark((function e(t,n){var r,o,i,l,s,u,g,b,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],o=[],i=E+5,l=t.length>=i?i:t.length,s=n.length>=i?i:n.length,u=c.a.mark((function e(n){var r,i,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n].movieId,e.prev=1,e.next=4,f.a.get("/thirdPartyMovieApi/tmdbMovies/searchOneById/".concat(r));case 4:i=e.sent,l=i.data,s=t.filter((function(e){return e.movieId===r})),u=s.length>0&&s[0],l.nextStoryTags=u?u.nextStoryTags:[],o.push(l),H((function(e){return[].concat(Object(a.a)(e),[l])})),F((function(e){return[].concat(Object(a.a)(e),[l])})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})),g=E;case 7:if(!(g<l)){e.next=12;break}return e.delegateYield(u(g),"t0",9);case 9:g++,e.next=7;break;case 12:b=c.a.mark((function e(t){var o,i,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n[t].bookId,e.prev=1,e.next=4,f.a.get("/thirdPartyBookApi/googleBooks/searchOneById/".concat(o));case 4:i=e.sent,l=i.data,s=n.filter((function(e){return e.bookId===o})),u=s.length>0&&s[0],l.nextStoryTags=u?u.nextStoryTags:[],r.push(l),H((function(e){return[].concat(Object(a.a)(e),[l])})),B((function(e){return[].concat(Object(a.a)(e),[l])})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})),h=E;case 14:if(!(h<s)){e.next=19;break}return e.delegateYield(b(h),"t1",16);case 16:h++,e.next=14;break;case 19:return 0===o.length&&V(!1),0===r.length&&Y(!1),e.abrupt("return",[o,r]);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(o.a)(c.a.mark((function e(){var t,n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.prev=2,e.next=5,f.a.get("/thirdPartyMovieApi/tmdbMovies/singleQuery/".concat(v,"/").concat(y,"/").concat(E,"/").concat(5));case 5:r=e.sent,0===(t=r.data).length?V(!1):(F((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t))})),H((function(e){return[].concat(Object(a.a)(e),Object(a.a)(t))}))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:return e.prev=13,e.next=16,f.a.get("/thirdPartyBookApi/googleBooks/singleQuery/".concat(v,"/").concat(y,"/").concat(E,"/").concat(5));case 16:o=e.sent,0===(n=o.data).length?Y(!1):(B((function(e){return[].concat(Object(a.a)(e),Object(a.a)(n))})),H((function(e){return[].concat(Object(a.a)(e),Object(a.a)(n))}))),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(13),console.log(e.t1);case 24:return e.abrupt("return",[t,n]);case 25:case"end":return e.stop()}}),e,null,[[2,10],[13,21]])})))).apply(this,arguments)}Object(l.useEffect)((function(){z(n)}),[n]),Object(l.useEffect)((function(){switch(v){case h.b.tag:(function(){return q.apply(this,arguments)})().then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];console.log("mongo movies and books:",e),function(e,t){return G.apply(this,arguments)}(n,a).then((function(e){var t=Object(i.a)(e,2);t[0],t[1]})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}));break;case h.b.searchBar:case h.b.genre:case h.b.moviePerson:case h.b.bookPerson:(function(){return K.apply(this,arguments)})().then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];console.log([n,a])})).catch((function(e){return console.log(e)}))}}),[v,y,E]);var X=Object(l.useMemo)((function(){switch(Q){case O.d:return w;case O.b:return C;case O.a:default:return L}}),[Q,w,C,L]),Z=Object(l.useMemo)((function(){switch(Q){case O.d:return W;case O.b:return J;case O.a:default:return W||J}}),[Q,J,W]);return s.a.createElement(u.a,{maxWidth:"md"},s.a.createElement(g.a,{variant:"h1"},"Search Results"),s.a.createElement("br",null),s.a.createElement(p.a,{isSearchPage:!0}),s.a.createElement("br",null),s.a.createElement(m.a,{resultsToDisplay:X,hasMore:Z,doNext:function(){S(E+5)}}),s.a.createElement("br",null),s.a.createElement(d.a,{isSearchPage:!0}))}))}}]);
//# sourceMappingURL=13.861c9364.chunk.js.map